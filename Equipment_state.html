<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" type="text/css" href="css/style.css" />
		<link rel="stylesheet" type="text/css" href="css/Equipment_state.css" />
		<style>
			.mui-scroll-wrapper {
				overflow: auto!important;
			}
			
			.state_content_con_first {
				text-align: left;
			}
			
			.state_content_con_first span {
				overflow: hidden;
				text-overflow: ellipsis;
				white-space: nowrap;
			}
			
			.state_content_con {
				padding: 0.3rem 0.2rem 0.3rem 1rem;
			}

		</style>
	</head>

	<body>

			</aside>-->
		<div class="mui-inner-wrap">

			<div id="offCanvasContentScroll" class="mui-content mui-scroll-wrapper">

					<header class="mui-bar mui-bar-nav titBackg" style="z-index: 99999999;">
						<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
						<h1 class="mui-title">设备状态</h1>
						<a id='searchCode' class="mui-icon mui-icon-search equipStatus_search"></a>
					</header>
<div class="wrap" style="margin-top: 50px;">
					<div class="mui-content">
						<div id="state_content_con state_content_skip" class="base">
								<div class="state_content_con" style="background: #F5F5F5;">
								<p class="state_content_con_first">
									<span>
									<span id="Hydrant">消火栓</span>
									<span id="HydrantCount">979</span>
									</span>
								</p>

								<p  class="pc_color">
									<span id="NormalUse">940</span>
									<span>正常使用</span>
								</p>
								<p  class="pc_color">
									<span id="StopUse">31</span>
									<span>停用停机</span>
								</p>
								<p  class="pc_color">
									<span id="FailureRepair">8</span>
									<span>故障维修</span>
								</p>
								<p  class="pc_color">
									<span id="ScrapProces">0</span>
									<span>报废处理</span>
								</p>
							</div>
						</div>
					</div>
					<div class="mui-content">
						<div id="state_content_con state_content_skip" class="base">
							<div id="PartitionView" class="state_content_con">
							<div id="state_title">
								<p id="engineering" class="state_title_area">行政办公区A1工程</p>
								<span id="group" class="state_title_offo">北京城建集团</span>
							</div>
								<p class="state_content_con_first" style="margin-right: 1rem;">
									<span id="EquipmentAll" class="state_count">217</span>
								</p>

								<p class="pc_color">
									<span>940</span>
									<span>正常使用</span>
								</p>
								<p class="pc_color">
									<span>31</span>
									<span>停用停机</span>
								</p>
								<p class="pc_color">
									<span>8</span>
									<span>故障维修</span>
								</p>
								<p class="pc_color">
									<span>0</span>
									<span>报废处理</span>
								</p>
							</div>
						</div>
					</div>
					<div class="mui-content">
						<div id="state_content_con state_content_skip" class="base">
							
							<div id="PartitionView" class="state_content_con">
							<div id="state_title">
								<p class="state_title_area">行政办公区B4工程</p>
								<span class="state_title_offo">北京城建集团</span>
							</div>
								<p class="state_content_con_first" style="margin-right: 1rem;">
									<span class="state_count">115</span>
								</p>

								<p class="pc_color">
									<span>940</span>
									<span>正常使用</span>
								</p>
								<p class="pc_color">
									<span>31</span>
									<span>停用停机</span>
								</p>
								<p class="pc_color">
									<span>8</span>
									<span>故障维修</span>
								</p>
								<p class="pc_color">
									<span>0</span>
									<span>报废处理</span>
								</p>
							</div>
						</div>
					</div>
					<div class="mui-content">
						<div id="state_content_con state_content_skip" class="base">
							
							<div id="PartitionView" class="state_content_con">
							<div id="state_title">
								<p class="state_title_area">行政办公区A2工程</p>
								<span class="state_title_offo">北京城建集团</span>
							</div>
								<p class="state_content_con_first" style="margin-right: 1rem;">
									<span class="state_count">347</span>
								</p>

								<p class="pc_color" style="margin-left: 0;">
									<span>940</span>
									<span>正常使用</span>
								</p>
								<p class="pc_color">
									<span>31</span>
									<span>停用停机</span>
								</p>
								<p class="pc_color">
									<span>8</span>
									<span>故障维修</span>
								</p>
								<p class="pc_color">
									<span>0</span>
									<span>报废处理</span>
								</p>
							</div>
						</div>
					</div>
</div>
		<script src="js/mui.min.js"></script>
		<!--<script src="js/echarts.min.js"></script>
		<script src="js/Equipment_state.js"></script>
		<script src="js/area.js"></script>-->
		<script src="js/searchCode.js"></script>
			<script type="text/javascript">
			(function($){
				$(".mui-scroll-wrapper").scroll({
					bounce: false,//滚动条是否有弹力默认是true
					indicators: false, //是否显示滚动条,默认是true
				});
				
				mui.plusReady(function () {
					//接口 
					function WebApp_EquipmentView (UnitCode){
		
						var data ={
							OrganiseUnitID: localStorage.getItem("UnitCode")
						};
						urlg = 'http://' + localStorage.getItem("serverAddress") + ':' + localStorage.getItem("portNum") + '/WebApi/DataExchange/GetData/TZDH_WebApp_EMBEquipmentStatus_Statistical?dateKey=00-00-00-00';
						
						mui.ajax(urlg, {
							data: data,
							dataType: 'json',
							type: 'get',
							timeout: 5000,
							success: function(data){
								
								var info = data['DataSource']['Tables'][0]["Datas"][0];
//								var getInfo = data['DataSource']['Tables'][0]["Datas"][0];
								var html = '';
								
								var Hydrant = info["Hydrant"]; 	//消火栓
								var OrganiseUnitID = info["OrganiseUnitID"]; 	//单位ID
								var OrganiseUnitName = info["OrganiseUnitName"]; 	//单位名称
								var ParentOrganiseUnitName = info["ParentOrganiseUnitName"]; 			//父单位名称
								var AllCount = info["AllCount"]; 		//消火栓总数量
								var NormalCount = info["NormalCount"];			 //正常使用
								var StopCount = info["StopCount"]; 			//停用停机
								var RepairCount = info["RepairCount"];  		//故障维修
								var ScrapCount = info["ScrapCount"];  	//报废数量
								
								function setHtml(data){
									document.getElementById("Hydrant").innerHTML = Hydrant || 0;
									document.getElementById("HydrantCount").innerHTML = NormalCount || 0; //消火栓总数量或者为 0
									document.getElementById("NormalUse").innerHTML = NormalCount || 0;
									document.getElementById("StopUse").innerHTML = StopCount || 0;
									document.getElementById("FailureRepair").innerHTML = RepairCount || 0;
									document.getElementById("ScrapProcess").innerHTML = ScrapCount || 0;
									
								};
								
								mui.each(getInfo, function(index, item) {
									
									//列表拼接
									html += '<div id="state_title">' + 
												'<p id="engineering" class="state_title_area">' + item.OrganiseUnitName + '</p>' + 
												'<span id="group" class="state_title_offo">' + item.ParentOrganiseUnitName + '</span>' + 
											'</div>' + 
											'<p class="state_content_con_first" style="margin-right: 1rem;">' + 
												'<span id="EquipmentAll" class="state_count">' + item.AllCount + '</span>' + 
											'</p>' + 
		
											'<p class="pc_color">' + 
												'<span>' + item.NormalCount + '</span>' + 
												'<span>' + '正常使用' + '</span>' + 
											'</p>' + 
											'<p class="pc_color">' + 
												'<span>' + item.StopCount + '</span>' + 
												'<span>' + '停用停机' + '</span>' + 
											'</p>' + 
											'<p class="pc_color">' + 
												'<span>' + item.RepairCount + '</span>' + 
												'<span>' + '故障维修' + '</span>' + 
											'</p>' + 
											'<p class="pc_color">' + 
												'<span>' + item.ScrapCount + '</span>' + 
												'<span>' + '报废处理' + '</span>' +
											'</p>';

								});
								
								document.getElementById("PartitionView").innerHTML = html;
								
							},
							
							error: function(){
								mui.toast('数据请求失败')
							}
						});

					}
					
					WebApp_EquipmentView(localStorage.getItem('UnitCode'));
				});
				
				mui('.wrap').on('tap', '.state_content_con', function() {
					
					mui.openWindow({
						url: 'Equipment_state_Account.html',
						id: 'Equipment_state_Account.html',
						styles: {
							top: 0, //新页面顶部位置
							bottom: 0, //新页面底部位置
						},
						extras: {
							ClassCode: "ddNum"
							//自定义扩展参数，可以用来处理页面间传值
						},
						show: {
							duration: '300'
						},
						waiting: {
							autoShow: true, //自动显示等待框，默认为true
							title: '加载中...', //等待对话框上显示的提示内容
						}
					});
						
				})
				
			})(mui);
		</script>
	</body>

</html>