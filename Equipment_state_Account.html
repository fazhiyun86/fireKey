<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" type="text/css" href="css/style.css" />
		<link rel="stylesheet" type="text/css" href="css/Equipment_state_Account.css"/>
		<style>

		</style>
	</head>

	<body>
		<div>
			<header class="mui-bar mui-bar-nav titBackg">
				<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
				<h1 class="mui-title">设备资产台账</h1>
			</header>
			<div id="bg_tab">
				<div class="equipment_tab" id="tabWrap">
					<ul>
						<li class="equipment_tab_list tab_list" data-target="1"><a >故障维修</a></li>
						<li class="equipment_tab_list tab_list" data-target="2"><a>停用停机</a></li>
						<li class="equipment_tab_list tab_list" data-target="3"><a>正常使用</a></li>
						<li class="equipment_tab_list tab_list" data-target="4"><a>报废处理</a></li>
					</ul>
				</div>
				
				<div class="mui-content Equipment_state_Account_con" id="Account_con" style="padding-top: 0px;">
					<div class="Equipment_first">
						<p style="width: 25%;">名称</p>
						<p style="width: 30%;">编号</p> 
						<p style="width: 35%;">位置</p>
					</div>
					<div class="Equipment_c2" id="Equipment_c2">
						<div>
							<p style="width: 25%;">消火栓</p>
							<p style="width: 30%;">A200050</p>
							<p style="width: 35%;">行政办公区A1工程区</p>
						</div>
					</div>
				</div>
			</div>
		</div>
		<script src="js/mui.min.js"></script>
		<!--<script src="js/echarts.common.min.js"></script>-->
		<script src="js/Equipment_state_Account.js"></script>
		<script type="text/javascript">

				var list = document.getElementsByClassName("tab_list");
				var Account_con = document.getElementById("Account_con");
				var tabWrap = document.getElementById("tabWrap");

				mui("#tabWrap").on('tap', '.tab_list', function(e) {
					var targetVal = this.getAttribute("data-target");
					getData(targetVal)
          		});
          		
          		function getData (targetVal) {
          			
          			function WebApp_GetEqListByClass(UnitCode) {
          				
	          			var data ={
							OrganiseUnitID: localStorage.getItem("UnitCode")
						};
						urlg = 'http://' + localStorage.getItem("serverAddress") + ':' + localStorage.getItem("portNum") + '/WebApi/DataExchange/GetData/TZDH_WebApp_EMBEquipmentStatus_Statistical?dateKey=00-00-00-00';
						
						mui.ajax(urlg, {
							data: data,
							dataType: 'json',
							type: 'get',
							timeout: 5000,
							success: function(data){
								
//								var info = data['DataSource']['Tables'][0]["Datas"][0];
//								var html = '';								
//								var ClassName = info["ClassName"]; 	//设备分类名字/消火栓
//								var OrganiseUnitID = info["OrganiseUnitID"]; 	//单位ID
//								var OrganiseUnitName = info["OrganiseUnitName"]; 	//单位名称
//								var ParentOrganiseUnitName = info["ParentOrganiseUnitName"]; 			//父单位名称
//								var AllCount = info["AllCount"]; 		//消火栓总数量
//								var NormalCount = info["NormalCount"];			 //正常使用
//								var StopCount = info["StopCount"]; 			//停用停机

								mui.each(info, function(index, item) {
									//					<div>
									//						<p>烟感报警器</p>
									//						<p style="width:35%">CD45S64W4514</p>
									//						<p style="width:15%">正常</p>
									//					</div>
									html += 
										'<div class="conSend" style="overflow-x: hidden;">' +
										'<input class="sendId1" type="hidden"value="' + item.EquipmentCode + '" />' +
										'<p style="width:25%">' + item.EquipmentName + '</p>' +
										'<p style="width:30%">' + item.EquipmentCode + '</p>' +
										'<p style="width:35%">' + item.EquipmentStatus + '</p>' +
										'</div>';
								})
						
							document.getElementById("Equipment_c2").innerHTML = html;
										
							},
									
							error: function(){
								mui.toast('数据请求失败')
							}						
						});		
					}
					WebApp_GetEqListByClass(localStorage.getItem('UnitCode'))
		    	}

			(function($){			
				$(".mui-scroll-wrapper").scroll({
					bounce: false,//滚动条是否有弹力默认是true
					indicators: false, //是否显示滚动条,默认是true
				});

				mui.ready(function() {   
					mui('#Equipment_c2').on('tap', '.conSend', function() {
						var code = this.firstChild.value;
	//					console.log(code)
						localStorage.setItem('userNumCode', code)
						mui.openWindow({
							url: 'Equipment_state_query.html',
							id: 'Equipment_state_query.html',
							styles: {
								top: 0, //新页面顶部位置
								bottom: 0, //新页面底部位置
							},
							extras: {
	
							},
							show: {
								duration: '300'
							},
							waiting: {
								autoShow: true, //自动显示等待框，默认为true
								title: '加载中...', //等待对话框上显示的提示内容
							}
						});
	
					})
	
				})
				
			})(mui);
		</script>
	</body>

</html>